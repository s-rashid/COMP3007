;q4
(display "Enter a year: ")
(define year (read))
(display "Enter a month: ")
(define month (read))
(display "Enter a day: ")
(define day (read))

(define (vali-date?)
  (define (leap-year?)
    (if (= (modulo year 4) 0) #t #f))
  (define (vali-year?)
    (if (and (integer? year) (>= year 1)) #t #f))
  (define (vali-month?)
    (if (and (integer? month) (>= month 1) (<= month 12)) #t #f))
  (define (vali-day?)
    (cond ((and (leap-year?) (vali-year?) (= month 2) (>= day 1) (<= day 29)) #t)
          ((and (not (leap-year?)) (vali-year?) (= month 2) (>= day 1) (<= day 28)) #t)
          ((and (vali-year?) (vali-month?)
                (or (= month 1) (= month 3) (= month 5) (= month 7) (= month 8) (= month 10) (= month 12))
                (<= day 1) (>= 31)) #t)
          ((and (vali-year?) (vali-month?)
                (or (= month 4) (= month 6) (= month 9) (= month 11))
                (<= day 1) (>= 30)) #t)
          (else #f)))
  (if (and (vali-year?) (vali-month?) (vali-day?)) #t #f))
